<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>StreetStyle ‚Äî Tienda oficial</title>
  <meta name="description" content="StreetStyle: hoodies, gorras y busos oversize. Carrito con persistencia y pago sandbox PayPal."/>

  <style>
    /* ====== BRANDING STREETSTYLE (ESTILO IMAGEN AZUL) ====== */
    :root{
      /* Paleta urbana fr√≠a */
      --bg:#020617;        /* fondo general */
      --panel:#02081f;     /* paneles grandes */
      --card:#050f23;      /* tarjetas */
      --text:#e5f0ff;      /* texto principal */
      --muted:#7c8aab;     /* texto secundario */
      --accent:#38bdf8;    /* celeste principal */
      --accent-2:#0ea5e9;  /* celeste para detalles */
      --ok:#22c55e;        /* acciones OK */
      --warn:#ef4444;      /* eliminar */
      --info:#3b82f6;      /* finalizar */
      --border:#0f172a;    /* bordes */
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:radial-gradient(circle at top, #0b1220 0, #020617 45%, #000 100%);
      color:var(--text);
      padding:24px;
      min-height:100vh;
    }
    a{color:var(--accent);text-decoration:none}

    /* ====== HEADER ====== */
    header{
      background:linear-gradient(135deg, rgba(56,189,248,.25), transparent 45%) , var(--panel);
      padding:20px 24px 18px;
      border-radius:20px;
      margin-bottom:22px;
      border:1px solid rgba(15,23,42,.9);
      box-shadow:0 18px 45px rgba(15,23,42,.9);
    }
    .brand-row{
      display:flex;
      align-items:center;
      gap:18px;
    }
    .logo{
      width:72px;
      height:72px;
      border-radius:999px;
      border:2px solid rgba(148, 222, 255, .8);
      box-shadow:0 0 24px rgba(56,189,248,.6);
      object-fit:cover;
      background:#020617;
    }
    h1{
      margin:0;
      font-size:2.4rem;
      letter-spacing:1px;
      color:var(--accent);
    }
    .subbrand{
      font-size:.95rem;
      color:var(--muted);
      margin-top:4px;
    }
    .tagline{
      margin-top:6px;
      font-size:.95rem;
      color:#cbd5f5;
    }

    .filtros{
      margin-top:16px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      font-size:.9rem;
    }
    .filtros label{color:var(--muted)}
    select{
      background:rgba(15,23,42,.9);
      color:var(--text);
      border:1px solid var(--border);
      border-radius:999px;
      padding:8px 14px;
      font-size:.9rem;
    }
    select:focus{
      outline:2px solid var(--accent);
      outline-offset:2px;
    }

    /* ====== LAYOUT PRINCIPAL (PRODUCTOS + CARRITO) ====== */
    main{
      display:grid;
      grid-template-columns:minmax(0,2.2fr) minmax(320px,1.2fr);
      gap:24px;
      align-items:flex-start;
    }
    @media (max-width:900px){
      main{
        grid-template-columns:1fr;
      }
    }

    /* ====== GRID DE PRODUCTOS ====== */
    #productos{
      background:linear-gradient(145deg, rgba(15,23,42,.8), rgba(3,7,18,.95));
      border-radius:18px;
      padding:18px 18px 20px;
      border:1px solid var(--border);
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(210px,1fr));
      gap:16px;
    }
    #productos::before{
      content:"Explora nuestros productos";
      grid-column:1 / -1;
      font-weight:600;
      font-size:1.05rem;
      margin-bottom:4px;
      color:#e2f3ff;
    }
    .producto{
      background:radial-gradient(circle at top, rgba(56,189,248,.12), transparent 55%) , var(--card);
      border:1px solid rgba(15,23,42,.9);
      border-radius:16px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:6px;
      transition:transform .16s ease, box-shadow .16s ease, border-color .16s ease;
      box-shadow:0 8px 22px rgba(15,23,42,.75);
    }
    .producto:hover{
      transform:translateY(-3px);
      border-color:rgba(56,189,248,.7);
      box-shadow:0 14px 35px rgba(15,23,42,.95);
    }
    .producto img{
      width:100%;
      height:230px;
      object-fit:cover;
      border-radius:12px;
      background:#020617;
    }
    .producto h3{
      margin-top:8px;
      font-size:0.98rem;
    }
    .producto p{
      margin:0;
      font-size:.9rem;
      color:var(--muted);
    }
    .price{
      color:var(--accent);
      font-weight:600;
      font-size:1rem;
    }
    .button{
      margin-top:6px;
      background:linear-gradient(135deg, var(--accent), var(--accent-2));
      border:none;
      color:#020617;
      padding:9px 10px;
      border-radius:999px;
      cursor:pointer;
      font-weight:600;
      font-size:.9rem;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
    }
    .button::before{
      content:"+";
      font-weight:900;
    }
    .button:hover{
      filter:brightness(1.05);
      box-shadow:0 0 18px rgba(56,189,248,.55);
    }

    /* ====== CARRITO ====== */
    .carrito{
      background:radial-gradient(circle at top left, rgba(56,189,248,.26), transparent 55%) , var(--panel);
      padding:18px 18px 20px;
      border-radius:18px;
      border:1px solid var(--border);
      box-shadow:0 16px 35px rgba(15,23,42,.95);
    }
    .carrito h2{
      margin:0 0 4px;
      font-size:1.25rem;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .carrito h2::before{
      content:"üõí";
      font-size:1.1rem;
    }
    .carrito > p{
      margin:0 0 10px;
      color:var(--muted);
      font-size:.9rem;
    }
    #lista-carrito{
      list-style:none;
      padding:0;
      margin:10px 0 0;
      max-height:260px;
      overflow:auto;
      scrollbar-width:thin;
    }
    #lista-carrito li{
      background:rgba(15,23,42,.9);
      border:1px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:8px;
      font-size:.85rem;
    }
    #lista-carrito span:first-child{
      color:#e5e7eb;
    }
    .qty{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .qty button{
      border:1px solid var(--border);
      background:transparent;
      color:#e5e7eb;
      border-radius:8px;
      padding:3px 9px;
      cursor:pointer;
      font-size:.8rem;
    }
    .qty button:hover{
      border-color:var(--accent);
    }
    .qty span{
      min-width:18px;
      text-align:center;
    }
    .remove{
      background:var(--warn);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:4px 8px;
      cursor:pointer;
      font-size:.8rem;
    }

    .totales{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:6px;
      margin-top:12px;
      font-size:.9rem;
    }
    .totales p{margin:0;color:var(--muted);}
    .totales strong{color:#e5f0ff;}
    .totales .total{
      grid-column:1 / -1;
      margin-top:4px;
      font-size:1.05rem;
      color:#e5f0ff;
    }

    .acciones{
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .vaciar,.finalizar{
      border:none;
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
      font-size:.85rem;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .vaciar{
      background:rgba(239,68,68,.12);
      color:#fecaca;
      border:1px solid rgba(239,68,68,.45);
    }
    .vaciar:hover{background:rgba(239,68,68,.22);}
    .finalizar{
      background:linear-gradient(135deg,var(--info),#1d4ed8);
      color:#e5f0ff;
      border:1px solid rgba(37,99,235,.8);
    }
    .finalizar:hover{
      filter:brightness(1.05);
      box-shadow:0 0 16px rgba(37,99,235,.55);
    }

    .pago{
      margin-top:16px;
      background:rgba(15,23,42,.95);
      padding:12px;
      border-radius:14px;
      border:1px dashed var(--border);
      font-size:.88rem;
    }
    .pago h3{
      margin:0 0 6px;
      font-size:1rem;
    }
    .hint{
      background:rgba(15,23,42,.85);
      border:1px dashed var(--border);
      padding:10px 12px;
      border-radius:10px;
      color:var(--muted);
      margin-top:12px;
      font-size:.85rem;
    }

    /* Mensaje sin productos */
    #hints-vacios{
      margin-top:16px;
    }
  </style>
</head>
<body>
  <header role="banner">
    <div class="brand-row">
      <!-- Cambia la ruta de esta imagen por tu archivo real del Shiba -->
      <img src="shiba-streetstyle.png" alt="Mascota Shiba de StreetStyle" class="logo">
      <div>
        <h1>StreetStyle</h1>
        <p class="subbrand">by Juan Andr√©s</p>
        <p class="tagline">Ropa urbana hecha en Colombia ‚Äî hoodies, gorras y busos oversize.</p>
      </div>
    </div>

    <div class="filtros" role="region" aria-label="Filtros">
      <label for="categoria">Filtrar por categor√≠a:</label>
      <select id="categoria" name="categoria" aria-label="Filtrar por categor√≠a">
        <option value="todos">Todos</option>
        <option value="Hoodies">Hoodies</option>
        <option value="Gorras">Gorras</option>
        <option value="Busos oversize">Busos oversize</option>
      </select>
    </div>
  </header>

  <main id="main" tabindex="-1">
    <section id="productos" aria-live="polite" aria-busy="false"></section>

    <section class="carrito" aria-label="Carrito de compras">
      <h2>Carrito</h2>
      <p><strong>Productos en carrito: <span id="cantidad-carrito">0</span></strong></p>
      <ul id="lista-carrito"></ul>

      <div class="totales">
        <p>Subtotal: <strong id="subtotal-text">$0,00</strong></p>
        <p>Descuento: <strong id="descuento-text">$0,00</strong></p>
        <p>Impuestos: <strong id="impuestos-text">$0,00</strong></p>
        <p class="total">Total: <strong id="total-text">$0,00</strong></p>
      </div>

      <div class="acciones">
        <button id="btn-vaciar" class="vaciar" type="button">üßº Vaciar</button>
        <button id="btn-finalizar" class="finalizar" type="button">‚úÖ Finalizar</button>
      </div>

      <div class="pago">
        <h3>üí≥ M√©todo de pago</h3>
        <!-- Se muestra solo con total > 0 -->
        <div id="paypal-button-container" style="margin-top:10px; display:none;"></div>
        <p class="hint">Sandbox PayPal: reemplaza <code>client-id=sb</code> por tu Client ID de pruebas en el &lt;script&gt;.</p>
      </div>
    </section>

    <div id="hints-vacios" class="hint" style="display:none"></div>
  </main>

  <!-- SDK PayPal (sandbox). Deja sin par√°metro currency: se define en createOrder -->
  <script src="https://www.paypal.com/sdk/js?client-id=sb&components=buttons,funding-eligibility"></script>

  <script>
    /* =========================
       CONFIGURACI√ìN STREETSTYLE
       ========================= */
    const MONEDA   = 'COP';       // 'COP' (formato local) ‚Äî si tu sandbox no admite COP, cambia a 'USD'
    const LOCALE   = 'es-CO';
    const TAX_RATE = 0.19;        // IVA referencial 19%
    const DESCUENTO = 0.00;       // sin descuento inicial

    /* =========================
       DATASET OFICIAL
       ========================= */
    const productos = [
      { id: 1, nombre: 'Hoodie ‚ÄúBlack Street‚Äù',  categoria: 'Hoodies',        precio: 120000, img: 'https://via.placeholder.com/600x800?text=Hoodie+Black+Street' },
      { id: 2, nombre: 'Hoodie ‚ÄúRetro Gray‚Äù',    categoria: 'Hoodies',        precio: 115000, img: 'https://via.placeholder.com/600x800?text=Hoodie+Retro+Gray' },
      { id: 3, nombre: 'Gorra ‚ÄúNYC Flat‚Äù',       categoria: 'Gorras',         precio:  75000, img: 'https://via.placeholder.com/600x800?text=Gorra+NYC+Flat' },
      { id: 4, nombre: 'Gorra ‚ÄúClassic White‚Äù',  categoria: 'Gorras',         precio:  70000, img: 'https://via.placeholder.com/600x800?text=Gorra+Classic+White' },
      { id: 5, nombre: 'Buso Oversize ‚ÄúStorm‚Äù',  categoria: 'Busos oversize', precio:  95000, img: 'https://via.placeholder.com/600x800?text=Buso+Oversize+Storm' },
      { id: 6, nombre: 'Buso Oversize ‚ÄúSkyline‚Äù',categoria: 'Busos oversize', precio:  99000, img: 'https://via.placeholder.com/600x800?text=Buso+Oversize+Skyline' },
    ];

    /* =========================
       ESTADO + SELECTORES
       ========================= */
    let carrito = new Map();

    const el = {
      contProds: document.getElementById('productos'),
      lista:     document.getElementById('lista-carrito'),
      subtotal:  document.getElementById('subtotal-text'),
      impuestos: document.getElementById('impuestos-text'),
      descuento: document.getElementById('descuento-text'),
      total:     document.getElementById('total-text'),
      cantidad:  document.getElementById('cantidad-carrito'),
      select:    document.getElementById('categoria'),
      btnVaciar: document.getElementById('btn-vaciar'),
      btnFinal:  document.getElementById('btn-finalizar'),
      paypal:    document.getElementById('paypal-button-container'),
      hints:     document.getElementById('hints-vacios')
    };

    const money = new Intl.NumberFormat(LOCALE, { style: 'currency', currency: MONEDA });

    /* =========================
       RENDER DE PRODUCTOS
       ========================= */
    function renderProductos(lista){
      el.contProds.setAttribute('aria-busy','true');
      el.contProds.innerHTML = '';

      if (!Array.isArray(lista) || lista.length === 0){
        el.hints.style.display = 'block';
        el.hints.innerHTML = 'üëã A√∫n no has agregado productos.';
        el.contProds.setAttribute('aria-busy','false');
        return;
      } else {
        el.hints.style.display = 'none';
      }

      lista.forEach(p=>{
        const card = document.createElement('article');
        card.className = 'producto';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.nombre}">
          <h3>${p.nombre}</h3>
          <p>Precio: <strong class="price">${money.format(Number(p.precio)||0)}</strong></p>
          <button class="button" data-add="${p.id}">Agregar al carrito</button>
        `;
        const img = card.querySelector('img');
        img.addEventListener('error', ()=>{
          img.src = 'https://via.placeholder.com/400x600?text=Producto';
          img.alt = p.nombre + ' (imagen no disponible)';
        });
        el.contProds.appendChild(card);
      });

      el.contProds.setAttribute('aria-busy','false');
    }

    /* =========================
       FILTRO POR CATEGOR√çA
       ========================= */
    function filtrar(){
      const sel = el.select.value;
      const data = sel === 'todos' ? productos : productos.filter(p => String(p.categoria) === sel);
      renderProductos(data);
      localStorage.setItem('filtro_categoria', sel);
    }

    function cargarFiltro(){
      const f = localStorage.getItem('filtro_categoria');
      if (f) el.select.value = f;
    }

    /* =========================
       CARRITO + TOTALES
       ========================= */
    function persist(){ localStorage.setItem('carrito_streetstyle', JSON.stringify(Array.from(carrito.entries()))); }
    function load(){
      const data = localStorage.getItem('carrito_streetstyle');
      if (data){ carrito = new Map(JSON.parse(data)); }
    }

    function totales(){
      const subtotal = [...carrito.values()].reduce((a,i)=> a + Number(i.precio||0)*Number(i.cantidad||0), 0);
      const desc = Math.min(DESCUENTO, subtotal);
      const base = subtotal - desc;
      const impuestos = +(base * TAX_RATE).toFixed(2);
      const total = +(base + impuestos).toFixed(2);
      const cantidad = [...carrito.values()].reduce((a,i)=> a + Number(i.cantidad||0), 0);
      return { subtotal, descuento: desc, impuestos, total, cantidad };
    }

    function pintarCarrito(){
      el.lista.innerHTML = '';
      carrito.forEach(it=>{
        const li = document.createElement('li');
        li.innerHTML = `
          <span>${it.nombre} ‚Äî ${money.format(it.precio)} x ${it.cantidad}</span>
          <div class="qty">
            <button aria-label="Disminuir" data-dec="${it.id}">‚àí</button>
            <span>${it.cantidad}</span>
            <button aria-label="Aumentar" data-inc="${it.id}">+</button>
            <button class="remove" aria-label="Eliminar" data-del="${it.id}">‚ùå</button>
          </div>`;
        el.lista.appendChild(li);
      });
      const {subtotal,descuento,impuestos,total,cantidad} = totales();
      el.subtotal.textContent  = money.format(subtotal);
      el.descuento.textContent = money.format(descuento);
      el.impuestos.textContent = money.format(impuestos);
      el.total.textContent     = money.format(total);
      el.cantidad.textContent  = cantidad;

      el.paypal.style.display = total > 0 ? 'block' : 'none';
      renderPayPal(total);
    }

    function add(id){
      const p = productos.find(x=> x.id === id);
      if(!p) return alert('Producto no encontrado.');
      const it = carrito.get(id);
      if (it) it.cantidad++; else carrito.set(id, {...p, cantidad:1});
      persist(); pintarCarrito();
    }
    function dec(id){
      const it = carrito.get(id); if(!it) return;
      it.cantidad--; if (it.cantidad<=0) carrito.delete(id);
      persist(); pintarCarrito();
    }
    function del(id){ carrito.delete(id); persist(); pintarCarrito(); }

    /* =========================
       PAYPAL (sandbox)
       ========================= */
    let paypalRenderedTotal = null;
    function renderPayPal(total){
      if(!window.paypal) return;
      if(total <= 0){ paypalRenderedTotal=null; el.paypal.innerHTML=''; return; }
      if(paypalRenderedTotal === total && el.paypal.childElementCount > 0) return;

      paypalRenderedTotal = total;
      el.paypal.innerHTML = '';
      paypal.Buttons({
        style:{layout:'vertical', color:'gold'},
        createOrder:(data,actions)=>actions.order.create({
          purchase_units:[{ amount:{ value: total.toFixed(2), currency_code: MONEDA } }]
        }),
        onApprove:(data,actions)=>actions.order.capture().then(d=>{
          alert(`¬°Gracias ${d?.payer?.name?.given_name || 'cliente'}! Pago aprobado.`);
          carrito.clear(); persist(); pintarCarrito();
        }),
        onError:(err)=>{ console.error(err); alert('Error con el pago. Reintenta.'); }
      }).render('#paypal-button-container');
    }

    /* =========================
       EVENTOS
       ========================= */
    document.addEventListener('click', e=>{
      const addBtn=e.target.closest('[data-add]'); if(addBtn) add(+addBtn.dataset.add);
      const incBtn=e.target.closest('[data-inc]'); if(incBtn) add(+incBtn.dataset.inc);
      const decBtn=e.target.closest('[data-dec]'); if(decBtn) dec(+decBtn.dataset.dec);
      const delBtn=e.target.closest('[data-del]'); if(delBtn) del(+delBtn.dataset.del);
    });
    document.getElementById('categoria').addEventListener('change', filtrar);
    document.getElementById('btn-vaciar').addEventListener('click', ()=>{ if(confirm('¬øVaciar carrito?')){ carrito.clear(); persist(); pintarCarrito(); }});
    document.getElementById('btn-finalizar').addEventListener('click', ()=>{
      if(carrito.size===0) return alert('Carrito vac√≠o.');
      alert('Pedido confirmado (simulado).'); carrito.clear(); persist(); pintarCarrito();
    });

    /* =========================
       INIT
       ========================= */
    (function init(){
      cargarFiltro();
      renderProductos(productos);
      load();
      pintarCarrito();
      document.getElementById('main')?.focus({preventScroll:true});
    })();
  </script>
</body>
</html>
